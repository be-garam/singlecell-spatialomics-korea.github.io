---
layout: default
---

<div class="container mx-auto px-4">
  <div class="flex flex-wrap -mx-4">
    <div class="w-full md:w-1/4 px-4">
      <h3 class="text-lg font-semibold mb-4">Research Categories</h3>
      <ul>
        {% for research in site.researches %}
          <li>
            <a href="#" class="text-blue-600 hover:text-blue-800 research-link" data-url="{{ research.url }}">
              {{ research.title }}
            </a>
          </li>
        {% endfor %}
      </ul>
    </div>
    <div id="main-content" class="w-full md:w-1/2 px-4">
      <div class="research-content">
        {{ content }}
      </div>
    </div>
    <div id="table-of-contents" class="w-full md:w-1/4 px-4">
      <h3 class="text-lg font-semibold mb-4">Table of Contents</h3>
      <!-- Table of contents will be dynamically inserted here -->
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const mainContent = document.getElementById('main-content');
  const tableOfContents = document.getElementById('table-of-contents');
  const links = document.querySelectorAll('.research-link');

  links.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const url = this.getAttribute('data-url');
      fetch(url)
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.text();
        })
        .then(html => {
          const tempDiv = document.createElement('div');
          tempDiv.innerHTML = html;
          const content = tempDiv.querySelector('.research-content');
          if (content) {
            mainContent.querySelector('.research-content').innerHTML = content.innerHTML;
            updateTableOfContents();
          } else {
            mainContent.querySelector('.research-content').innerHTML = '<p>Content not found.</p>';
          }
        })
        .catch(error => {
          console.error('Error:', error);
          mainContent.querySelector('.research-content').innerHTML = '<p>Error loading content. Please try again later.</p>';
        });
    });
  });

  function updateTableOfContents() {
    const headings = mainContent.querySelectorAll('h1, h2, h3, h4, h5, h6');
    let tocHtml = '<ul>';
    headings.forEach(heading => {
      const headingId = heading.id || heading.textContent.toLowerCase().replace(/\s+/g, '-');
      heading.id = headingId;
      tocHtml += `<li><a href="#${headingId}">${heading.textContent}</a></li>`;
    });
    tocHtml += '</ul>';
    tableOfContents.innerHTML = tocHtml;
  }

  // Initial ToC update
  updateTableOfContents();
});
</script>